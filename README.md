 <h1 align="center"> HD44780 I2C Driver</h1>

 # Driver Overview #
 This driver is targeted for STM32 boards and HD44780-based I2C display modules. Currently works on 16x2 display such as the one shown below:
 <p align="center">
 <img src="https://user-images.githubusercontent.com/79535234/150162473-e139d7c3-d8eb-4695-877e-66c1ef45de0c.png" width="300" />
 <p>

 **Main featues:**
 * Standard LCD control (write, get cursor position, set cursor position, animate text, ...). Fully explained in [Driver Summary](#driver-summary) section.
 * Busy flag check and address counter read between commands.
 * User defined error handler if I2C communication between STM32 and HD44780 times out.
  
 # Hardware/Software Requirements #
 * LCD display with HD44780 driver.
 * [PCF8574-based 8-bit I/O to I2C module](https://www.amazon.com/1602LCD-Display-Serial-Interface-Arduino/dp/B01MXGXPKU/ref=asc_df_B01MXGXPKU/?tag=hyprod-20&linkCode=df0&hvadid=167146065113&hvpos=&hvnetw=g&hvrand=358405417949042193&hvpone=&hvptwo=&hvqmt=&hvdev=c&hvdvcmdl=&hvlocint=&hvlocphy=9004331&hvtargid=pla-305845701989&psc=1/) that operates in four bit mode.
 * STM32-based board and 5V supply for LCD.
 * STM32CubeIDE (HAL for I2C communication).
  
 # Porting #
 1. Add HD44780.c and HD44780.h into STM32CubeIDE project.
 2. Configure I2C pins using CubeMX and HAL-generated code.
 3. `#include "HD44780.h"`
 4. Define `HD44780_NUM_ROWS`, `HD44780_NUM_COLS`, and `HW061_I2C_ADDR` in `HD44780.h`.
 4. In `main.c` create a HD44780_TypeDef object and intialize display with `HD44780_Init()`.

**Initialization and Print Example**
   
`HD44780.h`
```C
#define HD44780_NUM_ROWS 		2
#define HD44780_NUM_COLS 		16
#define HW061_I2C_ADDR 			(0x27<<1) /* PCF8574 (pg. 13) */
```
   
`main.c`
```C
#include "main.h"
#include "HD44780.h"

I2C_HandleTypeDef hi2c1;              /* Automatically generated by HAL */
HD44780_HandleTypeDef HD44780_Handle; /* Create HD44780_TypeDef object */
   
void SystemClock_Config(void);        /* Automatically generated by HAL */
static void MX_GPIO_Init(void);       /* Automatically generated by HAL */
static void MX_I2C1_Init(void);       /* Automatically generated by HAL */

int main(void)
{
  HAL_Init();                         /* Automatically generated by HAL */
  SystemClock_Config();               /* Automatically generated by HAL */
  MX_GPIO_Init();                     /* Automatically generated by HAL */
  MX_I2C1_Init();                     /* Automatically generated by HAL */

  if (HD44780_Init(&hi2c1, &HD44780_Handle))              /* Returns true if initialization successful */
  {
	  HD44780_Print(&HD44780_Handle, "Hello World Row1");   /* Prints text on first row */
	  HD44780_Set_Cursor_Position(&HD44780_Handle, 1, 0);   /* Moves cursor to second row */
	  HD44780_Print(&HD44780_Handle, "Hello World Row2");   /* Prints text on second row */
  }
}
```

# Driver Summary #
 <table>
  <tr>
    <td> <strong>Function</strong> </td>
    <td><strong>Description</strong></td>
  </tr>
  
  <tr>
    <td> bool HD44780_Init(I2C_HandleTypeDef *I2C_Handle, HD44780_HandleTypeDef *Display_Handle) </td>
    <td> Initializes the display through a software reset and places cursor at (0,0) position. Returns true if successful. </td>
  </tr>
</table>
  
